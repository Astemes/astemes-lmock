
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Anton Sundqvist" name="author"/>
<link href="http://astemes.com/10_Introduction/" rel="canonical"/>
<link href="../Style/logo.png" rel="icon"/>
<meta content="mkdocs-1.2.3, mkdocs-material-7.3.4" name="generator"/>
<title>Introduction - Astemes LMock</title>
<link href="../assets/stylesheets/main.db9e7362.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.3f5d1f46.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
<link href="../Style/style.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="none" data-md-color-primary="none" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#introduction-to-lmock">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Astemes LMock" class="md-header__button md-logo" data-md-component="logo" href=".." title="Astemes LMock">
<img alt="logo" src="../Style/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Astemes LMock
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Introduction
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/astemes/astemes-lmock/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Astemes LMock" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Astemes LMock">
<img alt="logo" src="../Style/logo.png"/>
</a>
    Astemes LMock
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/astemes/astemes-lmock/" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Introduction
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Introduction
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#typical-use-case">
    Typical Use Case
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-mock-class">
    The Mock Class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api">
    API
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#expectations">
    Expectations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#comparisons">
    Comparisons
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#return-values">
    Return Values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-descriptions">
    Failure descriptions
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../30_Writing%20Tests%20Using%20Mocks/">
        Writing Tests Using Mocks
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../50_Framework%20Architecture/Framework%20Architecture/">
        Framework Architecture
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          License
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="License" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          License
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../90_License/10_Astemes%20LMock/LICENSE/">
        Astemes LMock
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../90_License/20_Astemes%20LUnit/LICENSE/">
        Astemes LUnit
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#typical-use-case">
    Typical Use Case
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-mock-class">
    The Mock Class
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api">
    API
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#expectations">
    Expectations
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#comparisons">
    Comparisons
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#return-values">
    Return Values
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-descriptions">
    Failure descriptions
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/astemes/astemes-lmock/edit/master/docs/10_Introduction/index.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"></path></svg>
</a>
<h1 id="introduction-to-lmock">Introduction to LMock</h1>
<p>This document introduces the basic features and components of LMock.
For a more detailed discussion on how to write mock-based tests using LMock, please see <a href="../30_Writing%20Tests%20Using%20Mocks">this page</a>.</p>
<h2 id="typical-use-case">Typical Use Case</h2>
<p>LMock is used to generate test doubles to replace concrete classes in unit and integration tests.
A LabVIEW interface must be used to define the VI:s which are to be mocked.
The system under test would typically depend on the abstract Interface and the concrete class would be used in the actual application. 
One typically starts with a first version of the Interface and crete a mock class for the interface.
This class would be used in tests to verify expected behavior and simulate return values during test.
The generated mock can later be updated when the mocked Interface changes.</p>
<h2 id="the-mock-class">The Mock Class</h2>
<p>LMock is designed for mocking LabVIEW Interfaces.
A mock may be generated from any Interface using the right click menu in the LabVIEW Project Explorer.
The generated mock class will inherit from the LMock <code>Mock.lvclass</code> and implement all the Dynamic Dispatch VI:s of the mocked Interface.
It will also provide a When VI for each Dynamic Dispatch VI.
When VI:s are used to declare return values <em>when</em> the VI is called.
If the mocked Interface changes, the mock may be updated using the right-click menu in the project explorer.</p>
<p>The <code>Mock.lvclass</code> implements the necessary boilerplate code for handling expectations, VI calls and return values.
The implementation uses LabVIEW queues, which is a very performant structure with little overhead.
This makes the performance orders of magnitude better than using something like VI server.</p>
<h2 id="api">API</h2>
<p>The LMock API can be found in the LMock Palette after installing the package.</p>
<p><img alt="api" src="img/lmock-api.png"/></p>
<p>It consists of three expectation VIs <code>Never.vi</code>, <code>One.vi</code> and <code>One or More.vi</code> as well as the <code>Verify.vi</code>.</p>
<p>A typical use case would be to first create a mock using its constructor, then configure expectations on the mock using the expectation API.
Once the expectations are configured the code under test would bwe exercised and the <code>Verify.vi</code> would finally be called.
This API method verifies that the expectations are met and generates the result description message.
Return values from each VI call may optionally be declared using the When API.</p>
<h2 id="expectations">Expectations</h2>
<p>The expectation API is designed for readability.
An expectation is declared using one of the provided API VIs together with a call to the expected Dynamic Dispatch VI.
The Dynamic Dispatch VI is implemented by the mock class and generated through scripting when creating/updating the mock.
An example is given below.</p>
<p><img alt="Expectation" src="img/Expectation.png"/></p>
<p>There is always a pair of VI:s for each declared expectation which would read as "expect <em>one of</em> vi_name.vi with <em>same inputs</em>". 
The following expectations may be used</p>
<ul>
<li>Never - Passes only if the declared VI call was never made</li>
<li>One - Passes only if the declared VI call is made exactly once</li>
<li>One or More - Passes if the declared VI call is made one or more times</li>
<li>Exactly - Passes only if the VI call is made exactly a given number of times</li>
<li>At Least - Passes if the VI Call is made at least a given number of times</li>
</ul>
<p>All the expectations are polymorphic and offers multiple comparison options used to declare <em>how</em> VI calls should be compared when validating a mock.</p>
<h2 id="comparisons">Comparisons</h2>
<p>Comparisons define <em>how</em> two VI calls should be compared and if they should be regarded as matching.
The available comparators are listed below.</p>
<ul>
<li>Identical Inputs - Requires all inputs to be equal for the VI calls to match</li>
<li>Anthing at Inputs - The inputs are ignored and the VI calls will match as long as the same VI is called</li>
<li>Matching String Inputs - Any string input will be regarded as a regular expression when the mock is configured, and matches if the expression matches the string value when the VI is called.</li>
<li>Tolerant Numeric Inputs - Any numeric input will need to be within the given tolerance when the VI is called for the VI call to be considered equal.</li>
</ul>
<h2 id="return-values">Return Values</h2>
<p>LMock provides an API for queueing up return values from a VI call through the When API.
Using the generated <code>When vi_name.vi</code> VI, return values for calls to the <code>vi_name.vi</code> are enqueued.
Each call to <code>vi_name.vi</code> will dequeue the next return values, using LabVIEW type-specific defaults if the queue is empty.</p>
<p><img alt="when API" src="img/when-api.png"/></p>
<p>The When API is slightly unconventional, as it reverses the direction of data flow to be right-to-left for return values.
Each indicator on the actual VI is replaced with a control on the corresponding When VI, which makes the code read nicely in a unit test.</p>
<h2 id="failure-descriptions">Failure descriptions</h2>
<p>One important feature of LMock is that it provides fluent failure descriptions when mocks are verified.
The descriptions explains, in plain English, the expected number of VI calls, how the VI:s are compared and lists calls made to the expected VI.
An example would be the following result description of a passing test</p>
<pre><code>Write to Log.vi Called Once with String Inputs Matching Expectation
Call 1: Text to Write: "Test" found in "22/07/2023 21:18:50 READ:   Test", error in (no error): No Error(Cluster) == No Error(Cluster)
</code></pre>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Next: Writing Tests Using Mocks" class="md-footer__link md-footer__link--next" href="../30_Writing%20Tests%20Using%20Mocks/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Writing Tests Using Mocks
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2023 - 2025 Astemes
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
            Material for MkDocs
          </a>
 ... <a class="link--pdf-download" download href="..\Astemes LMock.pdf" title="PDF">download PDF</a></div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.8397ff9e.min.js", "version": null}</script>
<script src="../assets/javascripts/bundle.1e84347e.min.js"></script>
</body>
</html>